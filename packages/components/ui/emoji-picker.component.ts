import {
    Component,
    ChangeDetectionStrategy,
    input,
    output,
    computed,
    signal,
    inject,
    ElementRef,
    QueryList,
    ViewChildren,
    ViewChild,
    AfterViewInit,
    OnDestroy,
} from '@angular/core';
import { FormsModule } from '@angular/forms';
import { cn } from '../lib/utils';
import { InputComponent } from './input.component';
import { ScrollAreaComponent } from './scroll-area.component';
import { TooltipDirective } from './tooltip.component';
import { EMOJI_DATA } from './emoji-data';

interface EmojiCategory {
    id: string;
    name: string;
    icon: string;
    emojis: string[];
}

const EMOJI_CATEGORIES: EmojiCategory[] = [
    {
        id: 'smileys',
        name: 'Smileys & Emotion',
        icon: 'ğŸ˜€',
        emojis: [
            'ğŸ˜€', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜', 'ğŸ˜†', 'ğŸ˜…', 'ğŸ¤£', 'ğŸ˜‚', 'ğŸ™‚', 'ğŸ™ƒ',
            'ğŸ˜‰', 'ğŸ˜Š', 'ğŸ˜‡', 'ğŸ¥°', 'ğŸ˜', 'ğŸ¤©', 'ğŸ˜˜', 'ğŸ˜—', 'â˜ºï¸', 'ğŸ˜š',
            'ğŸ˜™', 'ğŸ¥²', 'ğŸ˜‹', 'ğŸ˜›', 'ğŸ˜œ', 'ğŸ¤ª', 'ğŸ˜', 'ğŸ¤‘', 'ğŸ¤—', 'ğŸ¤­',
            'ğŸ¤«', 'ğŸ¤”', 'ğŸ¤', 'ğŸ¤¨', 'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜¶', 'ğŸ˜', 'ğŸ˜’', 'ğŸ™„',
            'ğŸ˜¬', 'ğŸ¤¥', 'ğŸ˜Œ', 'ğŸ˜”', 'ğŸ˜ª', 'ğŸ¤¤', 'ğŸ˜´', 'ğŸ˜·', 'ğŸ¤’', 'ğŸ¤•',
            'ğŸ¤¢', 'ğŸ¤®', 'ğŸ¤§', 'ğŸ¥µ', 'ğŸ¥¶', 'ğŸ¥´', 'ğŸ˜µ', 'ğŸ¤¯', 'ğŸ¤ ', 'ğŸ¥³',
            'ğŸ¥¸', 'ğŸ˜', 'ğŸ¤“', 'ğŸ§', 'ğŸ˜•', 'ğŸ˜Ÿ', 'ğŸ™', 'â˜¹ï¸', 'ğŸ˜®', 'ğŸ˜¯',
            'ğŸ˜²', 'ğŸ˜³', 'ğŸ¥º', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜¨', 'ğŸ˜°', 'ğŸ˜¥', 'ğŸ˜¢', 'ğŸ˜­',
            'ğŸ˜±', 'ğŸ˜–', 'ğŸ˜£', 'ğŸ˜', 'ğŸ˜“', 'ğŸ˜©', 'ğŸ˜«', 'ğŸ¥±', 'ğŸ˜¤', 'ğŸ˜¡',
            'ğŸ˜ ', 'ğŸ¤¬', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ’€', 'â˜ ï¸', 'ğŸ’©', 'ğŸ¤¡', 'ğŸ‘¹', 'ğŸ‘º',
            'ğŸ‘»', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ¤–', 'ğŸ˜º', 'ğŸ˜¸', 'ğŸ˜¹', 'ğŸ˜»', 'ğŸ˜¼', 'ğŸ˜½',
            'ğŸ™€', 'ğŸ˜¿', 'ğŸ˜¾', 'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š', 'ğŸ’‹', 'ğŸ’Œ', 'ğŸ’˜', 'ğŸ’',
            'ğŸ’–', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’•', 'ğŸ’Ÿ', 'â£ï¸', 'ğŸ’”', 'â¤ï¸', 'ğŸ§¡',
            'ğŸ’›', 'ğŸ’š', 'ğŸ’™', 'ğŸ’œ', 'ğŸ¤', 'ğŸ–¤', 'ğŸ¤', 'ğŸ’¯', 'ğŸ’¢', 'ğŸ’¥',
            'ğŸ’«', 'ğŸ’¦', 'ğŸ’¨', 'ğŸ•³ï¸', 'ğŸ’£', 'ğŸ’¬', 'ğŸ‘ï¸â€ğŸ—¨ï¸', 'ğŸ—¨ï¸', 'ğŸ—¯ï¸', 'ğŸ’­', 'ğŸ’¤',
        ],
    },
    {
        id: 'people',
        name: 'People & Body',
        icon: 'ğŸ‘‹',
        emojis: [
            'ğŸ‘‹', 'ğŸ¤š', 'ğŸ–ï¸', 'âœ‹', 'ğŸ––', 'ğŸ‘Œ', 'ğŸ¤Œ', 'ğŸ¤', 'âœŒï¸', 'ğŸ¤',
            'ğŸ¤Ÿ', 'ğŸ¤˜', 'ğŸ¤™', 'ğŸ‘ˆ', 'ğŸ‘‰', 'ğŸ‘†', 'ğŸ–•', 'ğŸ‘‡', 'â˜ï¸', 'ğŸ‘',
            'ğŸ‘', 'âœŠ', 'ğŸ‘Š', 'ğŸ¤›', 'ğŸ¤œ', 'ğŸ‘', 'ğŸ™Œ', 'ğŸ‘', 'ğŸ¤²', 'ğŸ¤',
            'ğŸ™', 'âœï¸', 'ğŸ’…', 'ğŸ¤³', 'ğŸ’ª', 'ğŸ¦¾', 'ğŸ¦¿', 'ğŸ¦µ', 'ğŸ¦¶', 'ğŸ‘‚',
            'ğŸ¦»', 'ğŸ‘ƒ', 'ğŸ§ ', 'ğŸ«€', 'ğŸ«', 'ğŸ¦·', 'ğŸ¦´', 'ğŸ‘€', 'ğŸ‘ï¸', 'ğŸ‘…',
            'ğŸ‘„', 'ğŸ‘¶', 'ğŸ§’', 'ğŸ‘¦', 'ğŸ‘§', 'ğŸ§‘', 'ğŸ‘±', 'ğŸ‘¨', 'ğŸ§”', 'ğŸ‘©',
            'ğŸ§“', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ™', 'ğŸ™', 'ğŸ™…', 'ğŸ™†', 'ğŸ’', 'ğŸ™‹', 'ğŸ§',
            'ğŸ™‡', 'ğŸ¤¦', 'ğŸ¤·', 'ğŸ‘®', 'ğŸ•µï¸', 'ğŸ’‚', 'ğŸ¥·', 'ğŸ‘·', 'ğŸ¤´', 'ğŸ‘¸',
            'ğŸ‘³', 'ğŸ‘²', 'ğŸ§•', 'ğŸ¤µ', 'ğŸ‘°', 'ğŸ¤°', 'ğŸ¤±', 'ğŸ‘¼', 'ğŸ…', 'ğŸ¤¶',
            'ğŸ¦¸', 'ğŸ¦¹', 'ğŸ§™', 'ğŸ§š', 'ğŸ§›', 'ğŸ§œ', 'ğŸ§', 'ğŸ§', 'ğŸ§Ÿ', 'ğŸ’†',
            'ğŸ’‡', 'ğŸš¶', 'ğŸ§', 'ğŸ§', 'ğŸƒ', 'ğŸ’ƒ', 'ğŸ•º', 'ğŸ•´ï¸', 'ğŸ‘¯', 'ğŸ§–',
            'ğŸ‘­', 'ğŸ‘«', 'ğŸ‘¬', 'ğŸ’', 'ğŸ’‘', 'ğŸ‘ª', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦',
        ],
    },
    {
        id: 'animals',
        name: 'Animals & Nature',
        icon: 'ğŸ»',
        emojis: [
            'ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ»â€â„ï¸', 'ğŸ¨',
            'ğŸ¯', 'ğŸ¦', 'ğŸ®', 'ğŸ·', 'ğŸ½', 'ğŸ¸', 'ğŸµ', 'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š',
            'ğŸ’', 'ğŸ”', 'ğŸ§', 'ğŸ¦', 'ğŸ¤', 'ğŸ£', 'ğŸ¥', 'ğŸ¦†', 'ğŸ¦…', 'ğŸ¦‰',
            'ğŸ¦‡', 'ğŸº', 'ğŸ—', 'ğŸ´', 'ğŸ¦„', 'ğŸ', 'ğŸª±', 'ğŸ›', 'ğŸ¦‹', 'ğŸŒ',
            'ğŸ', 'ğŸœ', 'ğŸª°', 'ğŸª²', 'ğŸª³', 'ğŸ¦Ÿ', 'ğŸ¦—', 'ğŸ•·ï¸', 'ğŸ•¸ï¸', 'ğŸ¦‚',
            'ğŸ¢', 'ğŸ', 'ğŸ¦', 'ğŸ¦–', 'ğŸ¦•', 'ğŸ™', 'ğŸ¦‘', 'ğŸ¦', 'ğŸ¦', 'ğŸ¦€',
            'ğŸ¡', 'ğŸ ', 'ğŸŸ', 'ğŸ¬', 'ğŸ³', 'ğŸ‹', 'ğŸ¦ˆ', 'ğŸŠ', 'ğŸ…', 'ğŸ†',
            'ğŸ¦“', 'ğŸ¦', 'ğŸ¦§', 'ğŸ¦£', 'ğŸ˜', 'ğŸ¦›', 'ğŸ¦', 'ğŸª', 'ğŸ«', 'ğŸ¦’',
            'ğŸ¦˜', 'ğŸ¦¬', 'ğŸƒ', 'ğŸ‚', 'ğŸ„', 'ğŸ', 'ğŸ–', 'ğŸ', 'ğŸ‘', 'ğŸ¦™',
            'ğŸ', 'ğŸ¦Œ', 'ğŸ•', 'ğŸ©', 'ğŸ¦®', 'ğŸ•â€ğŸ¦º', 'ğŸˆ', 'ğŸˆâ€â¬›', 'ğŸª¶', 'ğŸ“',
            'ğŸ¦ƒ', 'ğŸ¦¤', 'ğŸ¦š', 'ğŸ¦œ', 'ğŸ¦¢', 'ğŸ¦©', 'ğŸ•Šï¸', 'ğŸ‡', 'ğŸ¦', 'ğŸ¦¨',
            'ğŸ¦¡', 'ğŸ¦«', 'ğŸ¦¦', 'ğŸ¦¥', 'ğŸ', 'ğŸ€', 'ğŸ¿ï¸', 'ğŸ¦”', 'ğŸŒµ', 'ğŸ„',
            'ğŸŒ²', 'ğŸŒ³', 'ğŸŒ´', 'ğŸªµ', 'ğŸŒ±', 'ğŸŒ¿', 'â˜˜ï¸', 'ğŸ€', 'ğŸ', 'ğŸª´',
            'ğŸ‹', 'ğŸƒ', 'ğŸ‚', 'ğŸ', 'ğŸ„', 'ğŸš', 'ğŸª¨', 'ğŸŒ¾', 'ğŸ’', 'ğŸŒ·',
            'ğŸŒ¹', 'ğŸ¥€', 'ğŸŒº', 'ğŸŒ¸', 'ğŸŒ¼', 'ğŸŒ»', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ›', 'ğŸŒœ',
            'ğŸŒš', 'ğŸŒ•', 'ğŸŒ–', 'ğŸŒ—', 'ğŸŒ˜', 'ğŸŒ‘', 'ğŸŒ’', 'ğŸŒ“', 'ğŸŒ”', 'ğŸŒ™',
            'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸª', 'ğŸ’«', 'â­', 'ğŸŒŸ', 'âœ¨', 'âš¡', 'â˜„ï¸',
            'ğŸ’¥', 'ğŸ”¥', 'ğŸŒªï¸', 'ğŸŒˆ', 'â˜€ï¸', 'ğŸŒ¤ï¸', 'â›…', 'ğŸŒ¥ï¸', 'â˜ï¸', 'ğŸŒ¦ï¸',
            'ğŸŒ§ï¸', 'â›ˆï¸', 'ğŸŒ©ï¸', 'ğŸŒ¨ï¸', 'â„ï¸', 'â˜ƒï¸', 'â›„', 'ğŸŒ¬ï¸', 'ğŸ’¨', 'ğŸ’§',
            'ğŸ’¦', 'â˜”', 'â˜‚ï¸', 'ğŸŒŠ', 'ğŸŒ«ï¸',
        ],
    },
    {
        id: 'food',
        name: 'Food & Drink',
        icon: 'ğŸ”',
        emojis: [
            'ğŸ‡', 'ğŸˆ', 'ğŸ‰', 'ğŸŠ', 'ğŸ‹', 'ğŸŒ', 'ğŸ', 'ğŸ¥­', 'ğŸ', 'ğŸ',
            'ğŸ', 'ğŸ‘', 'ğŸ’', 'ğŸ“', 'ğŸ«', 'ğŸ¥', 'ğŸ…', 'ğŸ«’', 'ğŸ¥¥', 'ğŸ¥‘',
            'ğŸ†', 'ğŸ¥”', 'ğŸ¥•', 'ğŸŒ½', 'ğŸŒ¶ï¸', 'ğŸ«‘', 'ğŸ¥’', 'ğŸ¥¬', 'ğŸ¥¦', 'ğŸ§„',
            'ğŸ§…', 'ğŸ„', 'ğŸ¥œ', 'ğŸŒ°', 'ğŸ', 'ğŸ¥', 'ğŸ¥–', 'ğŸ«“', 'ğŸ¥¨', 'ğŸ¥¯',
            'ğŸ¥', 'ğŸ§‡', 'ğŸ§€', 'ğŸ–', 'ğŸ—', 'ğŸ¥©', 'ğŸ¥“', 'ğŸ”', 'ğŸŸ', 'ğŸ•',
            'ğŸŒ­', 'ğŸ¥ª', 'ğŸŒ®', 'ğŸŒ¯', 'ğŸ«”', 'ğŸ¥™', 'ğŸ§†', 'ğŸ¥š', 'ğŸ³', 'ğŸ¥˜',
            'ğŸ²', 'ğŸ«•', 'ğŸ¥£', 'ğŸ¥—', 'ğŸ¿', 'ğŸ§ˆ', 'ğŸ§‚', 'ğŸ¥«', 'ğŸ±', 'ğŸ˜',
            'ğŸ™', 'ğŸš', 'ğŸ›', 'ğŸœ', 'ğŸ', 'ğŸ ', 'ğŸ¢', 'ğŸ£', 'ğŸ¤', 'ğŸ¥',
            'ğŸ¥®', 'ğŸ¡', 'ğŸ¥Ÿ', 'ğŸ¥ ', 'ğŸ¥¡', 'ğŸ¦€', 'ğŸ¦', 'ğŸ¦', 'ğŸ¦‘', 'ğŸ¦ª',
            'ğŸ¦', 'ğŸ§', 'ğŸ¨', 'ğŸ©', 'ğŸª', 'ğŸ‚', 'ğŸ°', 'ğŸ§', 'ğŸ¥§', 'ğŸ«',
            'ğŸ¬', 'ğŸ­', 'ğŸ®', 'ğŸ¯', 'ğŸ¼', 'ğŸ¥›', 'â˜•', 'ğŸ«–', 'ğŸµ', 'ğŸ¶',
            'ğŸ¾', 'ğŸ·', 'ğŸ¸', 'ğŸ¹', 'ğŸº', 'ğŸ»', 'ğŸ¥‚', 'ğŸ¥ƒ', 'ğŸ¥¤', 'ğŸ§‹',
            'ğŸ§ƒ', 'ğŸ§‰', 'ğŸ§Š', 'ğŸ¥¢', 'ğŸ½ï¸', 'ğŸ´', 'ğŸ¥„', 'ğŸ”ª', 'ğŸº',
        ],
    },
    {
        id: 'activities',
        name: 'Activities',
        icon: 'âš½',
        emojis: [
            'âš½', 'ğŸ€', 'ğŸˆ', 'âš¾', 'ğŸ¥', 'ğŸ¾', 'ğŸ', 'ğŸ‰', 'ğŸ¥', 'ğŸ±',
            'ğŸª€', 'ğŸ“', 'ğŸ¸', 'ğŸ’', 'ğŸ‘', 'ğŸ¥', 'ğŸ', 'ğŸªƒ', 'ğŸ¥…', 'â›³',
            'ğŸª', 'ğŸ¹', 'ğŸ£', 'ğŸ¤¿', 'ğŸ¥Š', 'ğŸ¥‹', 'ğŸ½', 'ğŸ›¹', 'ğŸ›¼', 'ğŸ›·',
            'â›¸ï¸', 'ğŸ¥Œ', 'ğŸ¿', 'â›·ï¸', 'ğŸ‚', 'ğŸª‚', 'ğŸ‹ï¸', 'ğŸ¤¼', 'ğŸ¤¸', 'â›¹ï¸',
            'ğŸ¤º', 'ğŸ¤¾', 'ğŸŒï¸', 'ğŸ‡', 'â›ï¸', 'ğŸ§—', 'ğŸ¤½', 'ğŸŠ', 'ğŸš£', 'ğŸ§˜',
            'ğŸ„', 'ğŸ†', 'ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ…', 'ğŸ–ï¸', 'ğŸµï¸', 'ğŸ—ï¸', 'ğŸ«',
            'ğŸŸï¸', 'ğŸª', 'ğŸ¤¹', 'ğŸ­', 'ğŸ©°', 'ğŸ¨', 'ğŸ¬', 'ğŸ¤', 'ğŸ§', 'ğŸ¼',
            'ğŸ¹', 'ğŸ¥', 'ğŸª˜', 'ğŸ·', 'ğŸº', 'ğŸª—', 'ğŸ¸', 'ğŸª•', 'ğŸ»', 'ğŸ²',
            'â™Ÿï¸', 'ğŸ¯', 'ğŸ³', 'ğŸ®', 'ğŸ°', 'ğŸ§©',
        ],
    },
    {
        id: 'travel',
        name: 'Travel & Places',
        icon: 'ğŸš—',
        emojis: [
            'ğŸš—', 'ğŸš•', 'ğŸš™', 'ğŸšŒ', 'ğŸš', 'ğŸï¸', 'ğŸš“', 'ğŸš‘', 'ğŸš’', 'ğŸš',
            'ğŸ›»', 'ğŸšš', 'ğŸš›', 'ğŸšœ', 'ğŸ¦¯', 'ğŸ¦½', 'ğŸ¦¼', 'ğŸ›´', 'ğŸš²', 'ğŸ›µ',
            'ğŸï¸', 'ğŸ›º', 'ğŸš¨', 'ğŸš”', 'ğŸš', 'ğŸš˜', 'ğŸš–', 'ğŸš¡', 'ğŸš ', 'ğŸšŸ',
            'ğŸšƒ', 'ğŸš‹', 'ğŸš', 'ğŸš', 'ğŸš„', 'ğŸš…', 'ğŸšˆ', 'ğŸš‚', 'ğŸš†', 'ğŸš‡',
            'ğŸšŠ', 'ğŸš‰', 'âœˆï¸', 'ğŸ›«', 'ğŸ›¬', 'ğŸ›©ï¸', 'ğŸ’º', 'ğŸ›°ï¸', 'ğŸš€', 'ğŸ›¸',
            'ğŸš', 'ğŸ›¶', 'â›µ', 'ğŸš¤', 'ğŸ›¥ï¸', 'ğŸ›³ï¸', 'â›´ï¸', 'ğŸš¢', 'âš“', 'ğŸª',
            'â›½', 'ğŸš§', 'ğŸš¦', 'ğŸš¥', 'ğŸš', 'ğŸ—ºï¸', 'ğŸ—¿', 'ğŸ—½', 'ğŸ—¼', 'ğŸ°',
            'ğŸ¯', 'ğŸŸï¸', 'ğŸ¡', 'ğŸ¢', 'ğŸ ', 'â›²', 'â›±ï¸', 'ğŸ–ï¸', 'ğŸï¸', 'ğŸœï¸',
            'ğŸŒ‹', 'â›°ï¸', 'ğŸ”ï¸', 'ğŸ—»', 'ğŸ•ï¸', 'â›º', 'ğŸ›–', 'ğŸ ', 'ğŸ¡', 'ğŸ˜ï¸',
            'ğŸšï¸', 'ğŸ—ï¸', 'ğŸ­', 'ğŸ¢', 'ğŸ¬', 'ğŸ£', 'ğŸ¤', 'ğŸ¥', 'ğŸ¦', 'ğŸ¨',
            'ğŸª', 'ğŸ«', 'ğŸ©', 'ğŸ’’', 'ğŸ›ï¸', 'â›ª', 'ğŸ•Œ', 'ğŸ•', 'ğŸ›•', 'ğŸ•‹',
            'â›©ï¸', 'ğŸ›¤ï¸', 'ğŸ›£ï¸', 'ğŸ—¾', 'ğŸ‘', 'ğŸï¸', 'ğŸŒ…', 'ğŸŒ„', 'ğŸŒ ', 'ğŸ‡',
            'ğŸ†', 'ğŸŒ‡', 'ğŸŒ†', 'ğŸ™ï¸', 'ğŸŒƒ', 'ğŸŒŒ', 'ğŸŒ‰', 'ğŸŒ',
        ],
    },
    {
        id: 'objects',
        name: 'Objects',
        icon: 'ğŸ’¡',
        emojis: [
            'âŒš', 'ğŸ“±', 'ğŸ“²', 'ğŸ’»', 'âŒ¨ï¸', 'ğŸ–¥ï¸', 'ğŸ–¨ï¸', 'ğŸ–±ï¸', 'ğŸ–²ï¸', 'ğŸ•¹ï¸',
            'ğŸ—œï¸', 'ğŸ’½', 'ğŸ’¾', 'ğŸ’¿', 'ğŸ“€', 'ğŸ“¼', 'ğŸ“·', 'ğŸ“¸', 'ğŸ“¹', 'ğŸ¥',
            'ğŸ“½ï¸', 'ğŸï¸', 'ğŸ“', 'â˜ï¸', 'ğŸ“Ÿ', 'ğŸ“ ', 'ğŸ“º', 'ğŸ“»', 'ğŸ™ï¸', 'ğŸšï¸',
            'ğŸ›ï¸', 'ğŸ§­', 'â±ï¸', 'â²ï¸', 'â°', 'ğŸ•°ï¸', 'âŒ›', 'â³', 'ğŸ“¡', 'ğŸ”‹',
            'ğŸ”Œ', 'ğŸ’¡', 'ğŸ”¦', 'ğŸ•¯ï¸', 'ğŸª”', 'ğŸ§¯', 'ğŸ›¢ï¸', 'ğŸ’¸', 'ğŸ’µ', 'ğŸ’´',
            'ğŸ’¶', 'ğŸ’·', 'ğŸª™', 'ğŸ’°', 'ğŸ’³', 'ğŸ’', 'âš–ï¸', 'ğŸªœ', 'ğŸ§°', 'ğŸª›',
            'ğŸ”§', 'ğŸ”¨', 'âš’ï¸', 'ğŸ› ï¸', 'â›ï¸', 'ğŸªš', 'ğŸ”©', 'âš™ï¸', 'ğŸª¤', 'ğŸ§±',
            'â›“ï¸', 'ğŸ§²', 'ğŸ”«', 'ğŸ’£', 'ğŸ§¨', 'ğŸª“', 'ğŸ”ª', 'ğŸ—¡ï¸', 'âš”ï¸', 'ğŸ›¡ï¸',
            'ğŸš¬', 'âš°ï¸', 'ğŸª¦', 'âš±ï¸', 'ğŸº', 'ğŸ”®', 'ğŸ“¿', 'ğŸ§¿', 'ğŸ’ˆ', 'âš—ï¸',
            'ğŸ”­', 'ğŸ”¬', 'ğŸ•³ï¸', 'ğŸ©¹', 'ğŸ©º', 'ğŸ’Š', 'ğŸ’‰', 'ğŸ©¸', 'ğŸ§¬', 'ğŸ¦ ',
            'ğŸ§«', 'ğŸ§ª', 'ğŸŒ¡ï¸', 'ğŸ§¹', 'ğŸª ', 'ğŸ§º', 'ğŸ§»', 'ğŸš½', 'ğŸš°', 'ğŸš¿',
            'ğŸ›', 'ğŸ›€', 'ğŸ§¼', 'ğŸª¥', 'ğŸª’', 'ğŸ§½', 'ğŸª£', 'ğŸ§´', 'ğŸ›ï¸', 'ğŸ”‘',
            'ğŸ—ï¸', 'ğŸšª', 'ğŸª‘', 'ğŸ›‹ï¸', 'ğŸ›ï¸', 'ğŸ›Œ', 'ğŸ§¸', 'ğŸª†', 'ğŸ–¼ï¸', 'ğŸª',
            'ğŸªŸ', 'ğŸ›ï¸', 'ğŸ›’', 'ğŸ', 'ğŸˆ', 'ğŸ', 'ğŸ€', 'ğŸª„', 'ğŸª…', 'ğŸŠ',
            'ğŸ‰', 'ğŸ', 'ğŸ®', 'ğŸ', 'ğŸ§§', 'âœ‰ï¸', 'ğŸ“©', 'ğŸ“¨', 'ğŸ“§', 'ğŸ’Œ',
            'ğŸ“¥', 'ğŸ“¤', 'ğŸ“¦', 'ğŸ·ï¸', 'ğŸ“ª', 'ğŸ“«', 'ğŸ“¬', 'ğŸ“­', 'ğŸ“®', 'ğŸ“¯',
            'ğŸ“œ', 'ğŸ“ƒ', 'ğŸ“„', 'ğŸ“‘', 'ğŸ§¾', 'ğŸ“Š', 'ğŸ“ˆ', 'ğŸ“‰', 'ğŸ—’ï¸', 'ğŸ—“ï¸',
            'ğŸ“†', 'ğŸ“…', 'ğŸ—‘ï¸', 'ğŸ“‡', 'ğŸ—ƒï¸', 'ğŸ—³ï¸', 'ğŸ—„ï¸', 'ğŸ“‹', 'ğŸ“', 'ğŸ“‚',
            'ğŸ—‚ï¸', 'ğŸ—ï¸', 'ğŸ“°', 'ğŸ““', 'ğŸ“”', 'ğŸ“’', 'ğŸ“•', 'ğŸ“—', 'ğŸ“˜', 'ğŸ“™',
            'ğŸ“š', 'ğŸ“–', 'ğŸ”–', 'ğŸ§·', 'ğŸ”—', 'ğŸ“', 'ğŸ–‡ï¸', 'ğŸ“', 'ğŸ“', 'ğŸ§®',
            'ğŸ“Œ', 'ğŸ“', 'âœ‚ï¸', 'ğŸ–Šï¸', 'ğŸ–‹ï¸', 'âœ’ï¸', 'ğŸ–Œï¸', 'ğŸ–ï¸', 'ğŸ“', 'âœï¸',
            'ğŸ”', 'ğŸ”', 'ğŸ”', 'ğŸ”', 'ğŸ”’', 'ğŸ”“',
        ],
    },
    {
        id: 'symbols',
        name: 'Symbols',
        icon: 'â¤ï¸',
        emojis: [
            'â¤ï¸', 'ğŸ§¡', 'ğŸ’›', 'ğŸ’š', 'ğŸ’™', 'ğŸ’œ', 'ğŸ–¤', 'ğŸ¤', 'ğŸ¤', 'ğŸ’”',
            'â£ï¸', 'ğŸ’•', 'ğŸ’', 'ğŸ’“', 'ğŸ’—', 'ğŸ’–', 'ğŸ’˜', 'ğŸ’', 'ğŸ’Ÿ', 'â˜®ï¸',
            'âœï¸', 'â˜ªï¸', 'ğŸ•‰ï¸', 'â˜¸ï¸', 'âœ¡ï¸', 'ğŸ”¯', 'ğŸ•', 'â˜¯ï¸', 'â˜¦ï¸', 'ğŸ›',
            'â›', 'â™ˆ', 'â™‰', 'â™Š', 'â™‹', 'â™Œ', 'â™', 'â™', 'â™', 'â™',
            'â™‘', 'â™’', 'â™“', 'ğŸ†”', 'âš›ï¸', 'ğŸ‰‘', 'â˜¢ï¸', 'â˜£ï¸', 'ğŸ“´', 'ğŸ“³',
            'ğŸˆ¶', 'ğŸˆš', 'ğŸˆ¸', 'ğŸˆº', 'ğŸˆ·ï¸', 'âœ´ï¸', 'ğŸ†š', 'ğŸ’®', 'ğŸ‰', 'ãŠ™ï¸',
            'ãŠ—ï¸', 'ğŸˆ´', 'ğŸˆµ', 'ğŸˆ¹', 'ğŸˆ²', 'ğŸ…°ï¸', 'ğŸ…±ï¸', 'ğŸ†', 'ğŸ†‘', 'ğŸ…¾ï¸',
            'ğŸ†˜', 'âŒ', 'â­•', 'ğŸ›‘', 'â›”', 'ğŸ“›', 'ğŸš«', 'ğŸ’¯', 'ğŸ’¢', 'â™¨ï¸',
            'ğŸš·', 'ğŸš¯', 'ğŸš³', 'ğŸš±', 'ğŸ”', 'ğŸ“µ', 'ğŸš­', 'â—', 'â•', 'â“',
            'â”', 'â€¼ï¸', 'â‰ï¸', 'ğŸ”…', 'ğŸ”†', 'ã€½ï¸', 'âš ï¸', 'ğŸš¸', 'ğŸ”±', 'âšœï¸',
            'ğŸ”°', 'â™»ï¸', 'âœ…', 'ğŸˆ¯', 'ğŸ’¹', 'â‡ï¸', 'âœ³ï¸', 'â', 'ğŸŒ', 'ğŸ’ ',
            'â“‚ï¸', 'ğŸŒ€', 'ğŸ’¤', 'ğŸ§', 'ğŸš¾', 'â™¿', 'ğŸ…¿ï¸', 'ğŸ›—', 'ğŸˆ³', 'ğŸˆ‚ï¸',
            'ğŸ›‚', 'ğŸ›ƒ', 'ğŸ›„', 'ğŸ›…', 'ğŸš¹', 'ğŸšº', 'ğŸš¼', 'âš§ï¸', 'ğŸš»', 'ğŸš®',
            'ğŸ¦', 'ğŸ“¶', 'ğŸˆ', 'ğŸ”£', 'ğŸ”¤', 'ğŸ”¡', 'ğŸ” ', 'ğŸ†–', 'ğŸ†—', 'ğŸ†™',
            'ğŸ†’', 'ğŸ†•', 'ğŸ†“', '0ï¸âƒ£', '1ï¸âƒ£', '2ï¸âƒ£', '3ï¸âƒ£', '4ï¸âƒ£', '5ï¸âƒ£', '6ï¸âƒ£',
            '7ï¸âƒ£', '8ï¸âƒ£', '9ï¸âƒ£', 'ğŸ”Ÿ', 'ğŸ”¢', '#ï¸âƒ£', '*ï¸âƒ£', 'âï¸', 'â–¶ï¸', 'â¸ï¸',
            'â¯ï¸', 'â¹ï¸', 'âºï¸', 'â­ï¸', 'â®ï¸', 'â©', 'âª', 'â«', 'â¬', 'â—€ï¸',
            'ğŸ”¼', 'ğŸ”½', 'â¡ï¸', 'â¬…ï¸', 'â¬†ï¸', 'â¬‡ï¸', 'â†—ï¸', 'â†˜ï¸', 'â†™ï¸', 'â†–ï¸',
            'â†•ï¸', 'â†”ï¸', 'â†ªï¸', 'â†©ï¸', 'â¤´ï¸', 'â¤µï¸', 'ğŸ”€', 'ğŸ”', 'ğŸ”‚', 'ğŸ”„',
            'ğŸ”ƒ', 'ğŸµ', 'ğŸ¶', 'â•', 'â–', 'â—', 'âœ–ï¸', 'ğŸŸ°', 'â™¾ï¸', 'ğŸ’²',
            'ğŸ’±', 'â„¢ï¸', 'Â©ï¸', 'Â®ï¸', 'ã€°ï¸', 'â°', 'â¿', 'ğŸ”š', 'ğŸ”™', 'ğŸ”›',
            'ğŸ”', 'ğŸ”œ', 'âœ”ï¸', 'â˜‘ï¸', 'ğŸ”˜', 'ğŸ”´', 'ğŸŸ ', 'ğŸŸ¡', 'ğŸŸ¢', 'ğŸ”µ',
            'ğŸŸ£', 'âš«', 'âšª', 'ğŸŸ¤', 'ğŸ”º', 'ğŸ”»', 'ğŸ”¸', 'ğŸ”¹', 'ğŸ”¶', 'ğŸ”·',
            'ğŸ”³', 'ğŸ”²', 'â–ªï¸', 'â–«ï¸', 'â—¾', 'â—½', 'â—¼ï¸', 'â—»ï¸', 'ğŸŸ¥', 'ğŸŸ§',
            'ğŸŸ¨', 'ğŸŸ©', 'ğŸŸ¦', 'ğŸŸª', 'â¬›', 'â¬œ', 'ğŸŸ«', 'ğŸ”ˆ', 'ğŸ”‡', 'ğŸ”‰',
            'ğŸ”Š', 'ğŸ””', 'ğŸ”•', 'ğŸ“£', 'ğŸ“¢', 'ğŸ‘ï¸â€ğŸ—¨ï¸', 'ğŸ’¬', 'ğŸ’­', 'ğŸ—¯ï¸', 'â™ ï¸',
            'â™£ï¸', 'â™¥ï¸', 'â™¦ï¸', 'ğŸƒ', 'ğŸ´', 'ğŸ€„', 'ğŸ•', 'ğŸ•‘', 'ğŸ•’', 'ğŸ•“',
            'ğŸ•”', 'ğŸ••', 'ğŸ•–', 'ğŸ•—', 'ğŸ•˜', 'ğŸ•™', 'ğŸ•š', 'ğŸ•›', 'ğŸ•œ', 'ğŸ•',
            'ğŸ•', 'ğŸ•Ÿ', 'ğŸ• ', 'ğŸ•¡', 'ğŸ•¢', 'ğŸ•£', 'ğŸ•¤', 'ğŸ•¥', 'ğŸ•¦', 'ğŸ•§',
        ],
    },
    {
        id: 'flags',
        name: 'Flags',
        icon: 'ğŸ³ï¸',
        emojis: [
            'ğŸ³ï¸', 'ğŸ´', 'ğŸ´â€â˜ ï¸', 'ğŸ', 'ğŸš©', 'ğŸŒ', 'ğŸ³ï¸â€ğŸŒˆ', 'ğŸ³ï¸â€âš§ï¸', 'ğŸ‡ºğŸ‡³',
            'ğŸ‡¦ğŸ‡«', 'ğŸ‡¦ğŸ‡±', 'ğŸ‡©ğŸ‡¿', 'ğŸ‡¦ğŸ‡¸', 'ğŸ‡¦ğŸ‡©', 'ğŸ‡¦ğŸ‡´', 'ğŸ‡¦ğŸ‡®', 'ğŸ‡¦ğŸ‡¶', 'ğŸ‡¦ğŸ‡¬', 'ğŸ‡¦ğŸ‡·',
            'ğŸ‡¦ğŸ‡²', 'ğŸ‡¦ğŸ‡¼', 'ğŸ‡¦ğŸ‡º', 'ğŸ‡¦ğŸ‡¹', 'ğŸ‡¦ğŸ‡¿', 'ğŸ‡§ğŸ‡¸', 'ğŸ‡§ğŸ‡­', 'ğŸ‡§ğŸ‡©', 'ğŸ‡§ğŸ‡§', 'ğŸ‡§ğŸ‡¾',
            'ğŸ‡§ğŸ‡ª', 'ğŸ‡§ğŸ‡¿', 'ğŸ‡§ğŸ‡¯', 'ğŸ‡§ğŸ‡²', 'ğŸ‡§ğŸ‡¹', 'ğŸ‡§ğŸ‡´', 'ğŸ‡§ğŸ‡¦', 'ğŸ‡§ğŸ‡¼', 'ğŸ‡§ğŸ‡·', 'ğŸ‡»ğŸ‡¬',
            'ğŸ‡§ğŸ‡³', 'ğŸ‡§ğŸ‡¬', 'ğŸ‡§ğŸ‡«', 'ğŸ‡§ğŸ‡®', 'ğŸ‡°ğŸ‡­', 'ğŸ‡¨ğŸ‡²', 'ğŸ‡¨ğŸ‡¦', 'ğŸ‡®ğŸ‡¨', 'ğŸ‡¨ğŸ‡»', 'ğŸ‡§ğŸ‡¶',
            'ğŸ‡°ğŸ‡¾', 'ğŸ‡¨ğŸ‡«', 'ğŸ‡¹ğŸ‡©', 'ğŸ‡¨ğŸ‡±', 'ğŸ‡¨ğŸ‡³', 'ğŸ‡¨ğŸ‡½', 'ğŸ‡¨ğŸ‡¨', 'ğŸ‡¨ğŸ‡´', 'ğŸ‡°ğŸ‡²', 'ğŸ‡¨ğŸ‡¬',
            'ğŸ‡¨ğŸ‡©', 'ğŸ‡¨ğŸ‡°', 'ğŸ‡¨ğŸ‡·', 'ğŸ‡¨ğŸ‡®', 'ğŸ‡­ğŸ‡·', 'ğŸ‡¨ğŸ‡º', 'ğŸ‡¨ğŸ‡¼', 'ğŸ‡¨ğŸ‡¾', 'ğŸ‡¨ğŸ‡¿', 'ğŸ‡©ğŸ‡°',
            'ğŸ‡©ğŸ‡¯', 'ğŸ‡©ğŸ‡²', 'ğŸ‡©ğŸ‡´', 'ğŸ‡ªğŸ‡¨', 'ğŸ‡ªğŸ‡¬', 'ğŸ‡¸ğŸ‡»', 'ğŸ‡¬ğŸ‡¶', 'ğŸ‡ªğŸ‡·', 'ğŸ‡ªğŸ‡ª', 'ğŸ‡¸ğŸ‡¿',
            'ğŸ‡ªğŸ‡¹', 'ğŸ‡ªğŸ‡º', 'ğŸ‡«ğŸ‡°', 'ğŸ‡«ğŸ‡´', 'ğŸ‡«ğŸ‡¯', 'ğŸ‡«ğŸ‡®', 'ğŸ‡«ğŸ‡·', 'ğŸ‡¬ğŸ‡«', 'ğŸ‡µğŸ‡«', 'ğŸ‡¹ğŸ‡«',
            'ğŸ‡¬ğŸ‡¦', 'ğŸ‡¬ğŸ‡²', 'ğŸ‡¬ğŸ‡ª', 'ğŸ‡©ğŸ‡ª', 'ğŸ‡¬ğŸ‡­', 'ğŸ‡¬ğŸ‡®', 'ğŸ‡¬ğŸ‡·', 'ğŸ‡¬ğŸ‡±', 'ğŸ‡¬ğŸ‡©', 'ğŸ‡¬ğŸ‡µ',
            'ğŸ‡¬ğŸ‡º', 'ğŸ‡¬ğŸ‡¹', 'ğŸ‡¬ğŸ‡¬', 'ğŸ‡¬ğŸ‡³', 'ğŸ‡¬ğŸ‡¼', 'ğŸ‡¬ğŸ‡¾', 'ğŸ‡­ğŸ‡¹', 'ğŸ‡­ğŸ‡³', 'ğŸ‡­ğŸ‡°', 'ğŸ‡­ğŸ‡º',
            'ğŸ‡®ğŸ‡¸', 'ğŸ‡®ğŸ‡³', 'ğŸ‡®ğŸ‡©', 'ğŸ‡®ğŸ‡·', 'ğŸ‡®ğŸ‡¶', 'ğŸ‡®ğŸ‡ª', 'ğŸ‡®ğŸ‡²', 'ğŸ‡®ğŸ‡±', 'ğŸ‡®ğŸ‡¹', 'ğŸ‡¯ğŸ‡²',
            'ğŸ‡¯ğŸ‡µ', 'ğŸ‡¯ğŸ‡ª', 'ğŸ‡¯ğŸ‡´', 'ğŸ‡°ğŸ‡¿', 'ğŸ‡°ğŸ‡ª', 'ğŸ‡°ğŸ‡®', 'ğŸ‡½ğŸ‡°', 'ğŸ‡°ğŸ‡¼', 'ğŸ‡°ğŸ‡¬',
            'ğŸ‡±ğŸ‡¦', 'ğŸ‡±ğŸ‡»', 'ğŸ‡±ğŸ‡§', 'ğŸ‡±ğŸ‡¸', 'ğŸ‡±ğŸ‡·', 'ğŸ‡±ğŸ‡¾', 'ğŸ‡±ğŸ‡®', 'ğŸ‡±ğŸ‡¹', 'ğŸ‡±ğŸ‡º', 'ğŸ‡²ğŸ‡´',
            'ğŸ‡²ğŸ‡¬', 'ğŸ‡²ğŸ‡¼', 'ğŸ‡²ğŸ‡¾', 'ğŸ‡²ğŸ‡»', 'ğŸ‡²ğŸ‡±', 'ğŸ‡²ğŸ‡¹', 'ğŸ‡²ğŸ‡­', 'ğŸ‡²ğŸ‡¶', 'ğŸ‡²ğŸ‡·', 'ğŸ‡²ğŸ‡º',
            'ğŸ‡¾ğŸ‡¹', 'ğŸ‡²ğŸ‡½', 'ğŸ‡«ğŸ‡²', 'ğŸ‡²ğŸ‡©', 'ğŸ‡²ğŸ‡¨', 'ğŸ‡²ğŸ‡³', 'ğŸ‡²ğŸ‡ª', 'ğŸ‡²ğŸ‡¸', 'ğŸ‡²ğŸ‡¦', 'ğŸ‡²ğŸ‡¿',
            'ğŸ‡²ğŸ‡²', 'ğŸ‡³ğŸ‡¦', 'ğŸ‡³ğŸ‡·', 'ğŸ‡³ğŸ‡µ', 'ğŸ‡³ğŸ‡±', 'ğŸ‡³ğŸ‡¨', 'ğŸ‡³ğŸ‡¿', 'ğŸ‡³ğŸ‡®', 'ğŸ‡³ğŸ‡ª', 'ğŸ‡³ğŸ‡¬',
            'ğŸ‡³ğŸ‡º', 'ğŸ‡³ğŸ‡«', 'ğŸ‡°ğŸ‡µ', 'ğŸ‡²ğŸ‡°', 'ğŸ‡²ğŸ‡µ', 'ğŸ‡³ğŸ‡´', 'ğŸ‡´ğŸ‡²', 'ğŸ‡µğŸ‡°', 'ğŸ‡µğŸ‡¼', 'ğŸ‡µğŸ‡¸',
            'ğŸ‡µğŸ‡¦', 'ğŸ‡µğŸ‡¬', 'ğŸ‡µğŸ‡¾', 'ğŸ‡µğŸ‡ª', 'ğŸ‡µğŸ‡­', 'ğŸ‡µğŸ‡³', 'ğŸ‡µğŸ‡±', 'ğŸ‡µğŸ‡¹', 'ğŸ‡µğŸ‡·', 'ğŸ‡¶ğŸ‡¦',
            'ğŸ‡·ğŸ‡ª', 'ğŸ‡·ğŸ‡´', 'ğŸ‡·ğŸ‡º', 'ğŸ‡·ğŸ‡¼', 'ğŸ‡¼ğŸ‡¸', 'ğŸ‡¸ğŸ‡²', 'ğŸ‡¸ğŸ‡¹', 'ğŸ‡¸ğŸ‡¦', 'ğŸ‡¸ğŸ‡³', 'ğŸ‡·ğŸ‡¸',
            'ğŸ‡¸ğŸ‡¨', 'ğŸ‡¸ğŸ‡±', 'ğŸ‡¸ğŸ‡¬', 'ğŸ‡¸ğŸ‡½', 'ğŸ‡¸ğŸ‡°', 'ğŸ‡¸ğŸ‡®', 'ğŸ‡¬ğŸ‡¸', 'ğŸ‡¸ğŸ‡§', 'ğŸ‡¸ğŸ‡´', 'ğŸ‡¿ğŸ‡¦',
            'ğŸ‡°ğŸ‡·', 'ğŸ‡¸ğŸ‡¸', 'ğŸ‡ªğŸ‡¸', 'ğŸ‡±ğŸ‡°', 'ğŸ‡§ğŸ‡±', 'ğŸ‡¸ğŸ‡­', 'ğŸ‡°ğŸ‡³', 'ğŸ‡±ğŸ‡¨', 'ğŸ‡µğŸ‡²', 'ğŸ‡»ğŸ‡¨',
            'ğŸ‡¸ğŸ‡©', 'ğŸ‡¸ğŸ‡·', 'ğŸ‡¸ğŸ‡ª', 'ğŸ‡¨ğŸ‡­', 'ğŸ‡¸ğŸ‡¾', 'ğŸ‡¹ğŸ‡¼', 'ğŸ‡¹ğŸ‡¯', 'ğŸ‡¹ğŸ‡¿', 'ğŸ‡¹ğŸ‡­', 'ğŸ‡¹ğŸ‡±',
            'ğŸ‡¹ğŸ‡¬', 'ğŸ‡¹ğŸ‡°', 'ğŸ‡¹ğŸ‡´', 'ğŸ‡¹ğŸ‡¹', 'ğŸ‡¹ğŸ‡³', 'ğŸ‡¹ğŸ‡·', 'ğŸ‡¹ğŸ‡²', 'ğŸ‡¹ğŸ‡¨', 'ğŸ‡¹ğŸ‡»', 'ğŸ‡»ğŸ‡®',
            'ğŸ‡ºğŸ‡¬', 'ğŸ‡ºğŸ‡¦', 'ğŸ‡¦ğŸ‡ª', 'ğŸ‡¬ğŸ‡§', 'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿', 'ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿', 'ğŸ´ó §ó ¢ó ·ó ¬ó ³ó ¿', 'ğŸ‡ºğŸ‡¸', 'ğŸ‡ºğŸ‡¾', 'ğŸ‡ºğŸ‡¿',
            'ğŸ‡»ğŸ‡º', 'ğŸ‡»ğŸ‡¦', 'ğŸ‡»ğŸ‡ª', 'ğŸ‡»ğŸ‡³', 'ğŸ‡¼ğŸ‡«', 'ğŸ‡ªğŸ‡­', 'ğŸ‡¾ğŸ‡ª', 'ğŸ‡¿ğŸ‡²', 'ğŸ‡¿ğŸ‡¼',
        ],
    },
];

@Component({
    selector: 'ui-emoji-picker',
    changeDetection: ChangeDetectionStrategy.OnPush,
    template: `
        <div class="relative inline-block" [attr.data-slot]="'emoji-picker'">
            <ng-content />
        </div>
    `,
    host: {
        class: 'contents',
        '(document:click)': 'onDocumentClick($event)',
    },
})
export class EmojiPickerComponent {
    open = signal(false);
    closeOnSelect = input(true);
    emojiSelect = output<string>();

    toggle() {
        this.open.update(v => !v);
    }

    show() {
        this.open.set(true);
    }

    hide() {
        this.open.set(false);
    }

    selectEmoji(emoji: string) {
        this.emojiSelect.emit(emoji);
        if (this.closeOnSelect()) {
            this.open.set(false);
        }
    }

    onDocumentClick(event: MouseEvent) {
        const target = event.target as HTMLElement;
        if (!target.closest('[data-slot="emoji-picker"]')) {
            this.hide();
        }
    }
}

@Component({
    selector: 'ui-emoji-picker-trigger',
    changeDetection: ChangeDetectionStrategy.OnPush,
    template: `
        <span (click)="onClick($event)" [attr.data-slot]="'emoji-picker-trigger'">
            <ng-content />
        </span>
    `,
    host: { class: 'contents' },
})
export class EmojiPickerTriggerComponent {
    private picker = inject(EmojiPickerComponent, { optional: true });

    onClick(event: MouseEvent) {
        event.stopPropagation();
        this.picker?.toggle();
    }
}

@Component({
    selector: 'ui-emoji-picker-content',
    changeDetection: ChangeDetectionStrategy.OnPush,
    imports: [
        FormsModule,
        ScrollAreaComponent,
        TooltipDirective,
        InputComponent,
    ],
    template: `
        @if (picker?.open()) {
            <div
                [class]="contentClasses()"
                [attr.data-slot]="'emoji-picker-content'"
                [attr.data-state]="picker?.open() ? 'open' : 'closed'"
            >
                <div class="flex flex-col gap-3">
                    <!-- Search Input -->
                    <div class="relative">
                        <svg
                            class="absolute left-2.5 top-1/2 -translate-y-1/2 size-4 text-muted-foreground pointer-events-none"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <circle cx="11" cy="11" r="8" />
                            <path d="m21 21-4.3-4.3" />
                        </svg>
                        <ui-input
                            type="text"
                            placeholder="Search emojis..."
                            class="pl-8 h-8 text-sm"
                            [ngModel]="searchQuery()"
                            (ngModelChange)="searchQuery.set($event)"
                        />
                    </div>

                    <!-- Category Navigation -->
                    <div class="flex gap-1 pb-2 border-b border-border">
                        @for (category of categories; track category.id) {
                            <button
                                type="button"
                                [uiTooltip]="category.name"
                                [class]="categoryButtonClasses(category.id)"
                                (click)="scrollToCategory(category.id)"
                            >
                                {{ category.icon }}
                            </button>
                        }
                    </div>

                    <!-- Emoji Grid -->
                    <ui-scroll-area class="h-64">
                        <div class="pr-3">
                            @for (category of filteredCategories(); track category.id) {
                                <div
                                    class="mb-4"
                                    [attr.data-category]="category.id"
                                    #categorySection
                                >
                                    <div class="text-xs font-medium text-muted-foreground mb-2 sticky top-0 bg-popover py-1">
                                        {{ category.name }}
                                    </div>
                                    <div class="grid grid-cols-8 gap-0.5">
                                        @for (emoji of category.emojis; track emoji) {
                                            <button
                                                type="button"
                                                class="size-8 flex items-center justify-center text-xl rounded-md hover:bg-accent transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-1"
                                                (click)="selectEmoji(emoji)"
                                            >
                                                {{ emoji }}
                                            </button>
                                        }
                                    </div>
                                </div>
                            }
                            @if (filteredCategories().length === 0) {
                                <div class="flex flex-col items-center justify-center py-8 text-muted-foreground">
                                    <span class="text-3xl mb-2">ğŸ”</span>
                                    <span class="text-sm">No emojis found</span>
                                </div>
                            }
                        </div>
                    </ui-scroll-area>
                </div>
            </div>
        }
    `,
    host: { class: 'contents' },
})
export class EmojiPickerContentComponent implements AfterViewInit, OnDestroy {
    picker = inject(EmojiPickerComponent, { optional: true });
    private el = inject(ElementRef);

    class = input('');

    categories = EMOJI_CATEGORIES;
    searchQuery = signal('');
    activeCategory = signal('smileys');

    @ViewChildren('categorySection') categorySections!: QueryList<ElementRef<HTMLElement>>;

    private _scrollArea?: ScrollAreaComponent;
    @ViewChild(ScrollAreaComponent)
    set scrollArea(value: ScrollAreaComponent | undefined) {
        this._scrollArea = value;
        if (value?.viewportRef?.nativeElement) {
            this.setupScrollListener(value.viewportRef.nativeElement);
        } else {
            this.scrollRemoveListener?.();
            this.scrollRemoveListener = null;
        }
    }

    private scrollRemoveListener: (() => void) | null = null;
    private isScrollingProgrammatically = false;

    constructor() { }

    ngAfterViewInit() {
        this.categorySections.changes.subscribe(() => {
            this.onScroll();
        });
    }

    ngOnDestroy() {
        this.scrollRemoveListener?.();
    }

    contentClasses = computed(() =>
        cn(
            'absolute left-0 top-full z-50 mt-1 w-80 p-3 rounded-md border bg-popover text-popover-foreground shadow-md outline-none overflow-hidden',
            'animate-in fade-in-0 zoom-in-95',
            this.class()
        )
    );

    filteredCategories = computed(() => {
        const query = this.searchQuery().toLowerCase().trim();
        if (!query) {
            return this.categories;
        }

        return this.categories
            .map(category => ({
                ...category,
                emojis: category.emojis.filter(emoji => {
                    if (category.name.toLowerCase().includes(query)) return true;
                    if (emoji.includes(query)) return true;
                    const keywords = EMOJI_DATA[emoji];
                    return keywords?.some(keyword => keyword.toLowerCase().includes(query));
                }),
            }))
            .filter(category => category.emojis.length > 0);
    });

    categoryButtonClasses(categoryId: string) {
        const isActive = this.activeCategory() === categoryId;
        return cn(
            'size-8 flex items-center justify-center text-lg rounded-md transition-colors',
            'hover:bg-accent focus:outline-none focus:ring-2 focus:ring-ring',
            isActive && 'bg-accent'
        );
    }

    scrollToCategory(categoryId: string) {
        this.searchQuery.set('');
        this.activeCategory.set(categoryId);
        this.isScrollingProgrammatically = true;

        setTimeout(() => {
            const viewport = this._scrollArea?.viewportRef?.nativeElement;
            const section = this.el.nativeElement.querySelector(
                `[data-category="${categoryId}"]`
            ) as HTMLElement;

            if (section && viewport) {
                const relativeTop = section.getBoundingClientRect().top - viewport.getBoundingClientRect().top;
                const scrollTop = viewport.scrollTop + relativeTop;

                viewport.scrollTo({ top: scrollTop, behavior: 'smooth' });

                setTimeout(() => {
                    this.isScrollingProgrammatically = false;
                }, 800);
            } else {
                this.isScrollingProgrammatically = false;
            }
        });
    }

    private setupScrollListener(viewport: HTMLElement) {
        this.scrollRemoveListener?.();

        const listener = () => this.onScroll();
        viewport.addEventListener('scroll', listener, { passive: true });
        this.scrollRemoveListener = () => viewport.removeEventListener('scroll', listener);

        setTimeout(() => this.onScroll(), 0);
    }

    private onScroll() {
        if (this.isScrollingProgrammatically || !this._scrollArea?.viewportRef?.nativeElement) return;

        const viewport = this._scrollArea.viewportRef.nativeElement;
        const scrollTop = viewport.scrollTop;

        const buffer = 50;

        const sections = this.categorySections.toArray();
        let activeId: string | null = null;

        for (const section of sections) {
            const element = section.nativeElement;
            if (element.offsetTop <= scrollTop + buffer) {
                activeId = element.getAttribute('data-category');
            } else {
                break;
            }
        }

        if (activeId && activeId !== this.activeCategory()) {
            this.activeCategory.set(activeId);
        }
    }

    selectEmoji(emoji: string) {
        this.picker?.selectEmoji(emoji);
    }
}

